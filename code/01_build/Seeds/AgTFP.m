% AgTFP 1/15/2018
%
%  See Michael Webb email: https://mail.google.com/mail/u/0/#inbox/160dcf2d00ed64c8
%  and also this google doc: https://docs.google.com/document/d/1DZDGl3tYOjS3QWeLYbVEMxZQIMVQXD-7s2BIDLXDOVY/edit#heading=h.tk6zb1d6i6li
%
%  SOURCE:
%  The USDA Economic Research Service maintains indices of agricultural TFP
%  and components, at the national level and by state. Tables available
%  here: https://www.ers.usda.gov/data-products/agricultural-productivity-in-the-us.aspx

clear;
diarychad('AgTFP');


data=[
%Year	Total agricultural output	Total farm inputs	Total factor productivity	Total agricultural output per acre
%Year      Output       TotalInputs          TFP         Output/Acre
1948	1	1	1	1
1949	0.9851015504	1.0134108319	0.9720653455	0.9817440342
1950	0.961016744	1.019130106	0.9429774848	0.9554916183
1951	1.001188979	1.0349608404	0.9673689476	0.9944228885
1952	1.0329057268	1.0373776542	0.9956892001	1.0265355246
1953	1.0493993199	1.0338664494	1.015024059	1.0453925664
1954	1.0480634038	1.006048796	1.041761998	1.0488472073
1955	1.0767995543	1.0407666729	1.0346214788	1.0856041882
1956	1.083184861	1.0402669357	1.0412566466	1.103102773
1957	1.0702002658	1.0324533802	1.0365603778	1.1027832113
1958	1.1301302248	1.037933912	1.0888267661	1.1781130642
1959	1.1594724044	1.0672652762	1.0863956977	1.2195822759
1960	1.1965085566	1.0558962375	1.1331686904	1.2642859668
1961	1.2101367766	1.0360523594	1.1680266597	1.2806883649
1962	1.219760156	1.0497744663	1.1619259138	1.2917652876
1963	1.2635440049	1.0554188051	1.1971967893	1.3400532083
1964	1.2547252655	1.0399703287	1.206501023	1.3350453763
1965	1.2860629696	1.0409443616	1.2354771465	1.3765449922
1966	1.2793572297	1.0504905291	1.2178665054	1.3811953967
1967	1.3215807649	1.0559510025	1.2515550075	1.4427824418
1968	1.3418384398	1.05209868	1.2753921903	1.484866316
1969	1.368407565	1.0505096979	1.3026129771	1.5380755784
1970	1.3472115069	1.0417466204	1.2932237845	1.5402526428
1971	1.4379227059	1.0340017784	1.390638523	1.6720596045
1972	1.4437321727	1.044387698	1.3823718677	1.7042797103
1973	1.5125747264	1.0658245485	1.419159212	1.8057399775
1974	1.4308785183	1.0647737876	1.3438333428	1.7176881045
1975	1.5506416614	1.0456045857	1.4830096221	1.8594814776
1976	1.5584594784	1.085844742	1.4352507482	1.8597680213
1977	1.6319268581	1.0733902572	1.5203481186	1.9374992758
1978	1.6526256661	1.1458368081	1.4422871167	1.9584543883
1979	1.7515769894	1.1799183915	1.4844899461	2.0836425941
1980	1.6937191648	1.1968232136	1.415179072	2.0310994899
1981	1.8440128158	1.1514372003	1.6014879624	2.2334004682
1982	1.8708825819	1.121978842	1.667484726	2.2873944104
1983	1.6082409153	1.1131172771	1.4448081513	1.9802296997
1984	1.8334881371	1.0897494815	1.6824859	2.2692544557
1985	1.9041307296	1.04996093	1.8135253181	2.3667574245
1986	1.8386282237	1.044505527	1.7602857774	2.2952302862
1987	1.8545105572	1.0374450058	1.7875748082	2.3272469173
1988	1.7483333891	1.0316134454	1.6947563033	2.2088403899
1989	1.8910240111	1.0190221843	1.8557240856	2.4071267644
1990	1.9795750409	1.0219816363	1.9369966843	2.5380048942
1991	1.9888419046	1.0351621879	1.9212853095	2.5640465459
1992	2.1038087116	1.0078699914	2.0873810408	2.7192147142
1993	2.0018002736	1.0164373997	1.9694279985	2.5840724901
1994	2.2373809576	1.0467424494	2.1374703576	2.8773770288
1995	2.119777454	1.0794670558	1.9637259355	2.7139053248
1996	2.2218786093	1.0056838431	2.2093211745	2.8338537017
1997	2.3106202211	1.0411214098	2.2193571271	2.9415755806
1998	2.3254592671	1.050707868	2.2132310397	2.9633882609
1999	2.3794639541	1.059911619	2.2449644965	3.043906006
2000	2.3683645634	1.0469887284	2.2620726463	3.0479075321
2001	2.3837930836	1.0258295696	2.3237710768	3.0902356791
2002	2.3376368619	1.0189552256	2.2941507174	3.0535470624
2003	2.400518139	1.0024107558	2.3947449935	3.1576847703
2004	2.5151471152	0.9945630386	2.5288966285	3.3302396893
2005	2.4824475715	1.0063003319	2.4669052495	3.3082295056
2006	2.5002660377	1.0045793973	2.48886852	3.3540826566
2007	2.5458216785	1.0550278794	2.4130373503	3.438978659
2008	2.5642506463	1.0250548396	2.5015741083	3.4812825591
2009	2.5942036118	1.0013084071	2.5908137727	3.531237293
2010	2.5513805224	0.9951551848	2.5638016677	3.4764523557
2011	2.55204732	0.995580824	2.5633753268	3.4782573923
2012	2.540423466	0.9944481266	2.5546063168	3.4627224262
2013	2.7281890521	1.0089635092	2.7039521522	3.5667994979
2014	2.7023917613	1.0633528148	2.5413876971	3.5407370982
2015	2.6966560219	1.071547867	2.5165987492	3.5383431985
];

yrs=data(:,1);
Y=data(:,2);
Inputs=data(:,3);
tfp=data(:,4);
YperAcre=data(:,5);

figure(1); figsetup; makefigwide;
plot(yrs,[Y Inputs tfp YperAcre]);
chadfig2('Year','Index 1948=1',1,0);
print AgTFPlevels.eps

HPsmoother=400;
tfp_smooth=exp(hpfilter(log(tfp),HPsmoother));
YA_smooth=exp(hpfilter(log(YperAcre),HPsmoother));
%gtfp=hpfilter(delta(log(tfp)),HPsmoother);
%gYA =hpfilter(delta(log(YperAcre)),HPsmoother);
%gtfp=delta(log(tfp));
%gYA =delta(log(YperAcre));
%YrsToSmooth=8;
%gtfp=smooth(delta(log(tfp)),YrsToSmooth);
%gYA =smooth(delta(log(YperAcre)),YrsToSmooth);
gtfp=delta(log(tfp_smooth));
gYA =delta(log(YA_smooth));
gyrs=yrs(2:end);

definecolors;
figure(2); figsetup; makefigwide;
plot(gyrs,gtfp*100,'-','Color',myblue);
plot(gyrs,gYA*100,'-','Color',mygreen);
chadfig2('Year','Growth rate (smoothed)',1,0);
relabelaxis(0:3,'0% 1% 2% 3%');
text(1980,2.5,'Output per acre');
text(1970,1.2,'Total factor productivity');
print AgTFPgrowth.eps

cshow(' ',[gyrs gtfp gYA],'%6.0f %8.3f','Year gTFP gY/Acre');

disp ' ';
fprintf('Average TFP growth = %8.5f\n',mean(packr(gtfp)));
fprintf('Average Y/A growth = %8.5f\n',mean(packr(gYA)));

diary off;